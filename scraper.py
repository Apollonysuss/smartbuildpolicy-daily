import json
import datetime
import os
import random

# æ¨¡æ‹Ÿï¼šè¿™æ˜¯æˆ‘ä»¬çš„â€œAIå¤§è„‘â€ï¼Œç”¨æ¥ç”Ÿæˆæ‘˜è¦
# åœ¨çœŸå®åœºæ™¯ä¸­ï¼Œè¿™é‡Œä¼šæ›¿æ¢æˆ requests.get(url) å»æŠ“å–ç½‘é¡µæ­£æ–‡ï¼Œç„¶åå‘ç»™ ChatGPT
def generate_summary(title):
    # æ¨¡æ‹Ÿç”Ÿæˆçš„â€œæ™ºèƒ½æ‘˜è¦â€
    templates = [
        "ã€æ ¸å¿ƒæè¦ã€‘è¯¥æ”¿ç­–é‡ç‚¹å¼ºè°ƒäº†æ™ºèƒ½å»ºé€ æŠ€æœ¯çš„è½åœ°åº”ç”¨ï¼Œæ˜ç¡®äº†ç›¸å…³ä¼ä¸šçš„è¡¥è´´æ ‡å‡†ï¼Œå»ºè®®å…³æ³¨åç»­çš„ç”³æŠ¥ç»†åˆ™ã€‚",
        "ã€æ”¿ç­–åˆ©å¥½ã€‘æ–‡ä»¶æŒ‡å‡ºå°†åŠ å¤§å¯¹å»ºç­‘æœºå™¨äººçš„é‡‡è´­æ”¯æŒåŠ›åº¦ï¼Œå¯¹äºç‡å…ˆé‡‡ç”¨BIMæŠ€æœ¯çš„é¡¹ç›®ç»™äºˆç»¿è‰²é€šé“å®¡æ‰¹ã€‚",
        "ã€è¡Œä¸šé£å‘ã€‘ä½å»ºéƒ¨æœ€æ–°æŒ‡ç¤ºï¼Œè¦æ±‚å„åœ°åœ¨2025å¹´å‰å®Œæˆæ™ºèƒ½å»ºé€ è¯•ç‚¹é¡¹ç›®éªŒæ”¶ï¼Œç›¸å…³æ ‡å‡†å°†è¿›ä¸€æ­¥ç»Ÿä¸€ã€‚"
    ]
    return random.choice(templates)

def job():
    print("ğŸ¤– æœºå™¨äººæ­£åœ¨å¯åŠ¨...")
    print("1. æ­£åœ¨æ‰«æå…¨ç½‘æ”¿ç­–...")
    today = datetime.date.today().strftime("%Y-%m-%d")
    
    # æ¨¡æ‹ŸæŠ“å–åˆ°çš„æ–°æ•°æ®
    # æ³¨æ„ï¼šè¿™é‡Œæ–°å¢äº†ä¸€ä¸ª 'summary' (æ‘˜è¦) å­—æ®µ
    new_data = [
        {
            "id": str(random.randint(1000, 9999)),
            "title": f"ä½æˆ¿å’ŒåŸä¹¡å»ºè®¾éƒ¨å…³äºæ¨è¿›æ™ºèƒ½å»ºé€ è¯•ç‚¹çš„é€šçŸ¥ ({today})",
            "date": today,
            "source": "ä½å»ºéƒ¨å®˜ç½‘",
            "link": "https://www.mohurd.gov.cn", # åŸæ–‡é“¾æ¥
            "summary": "ã€æ ¸å¿ƒæ‘˜è¦ã€‘ä½å»ºéƒ¨ä»Šæ—¥å‘å¸ƒé€šçŸ¥ï¼Œé´é€‰å‡º24ä¸ªæ™ºèƒ½å»ºé€ è¯•ç‚¹åŸå¸‚ã€‚æ–‡ä»¶æ˜ç¡®äº†è¯•ç‚¹ç›®æ ‡ï¼Œè¦æ±‚åœ¨3å¹´å†…å»ºç«‹å®Œå–„çš„æ”¿ç­–ä½“ç³»ã€‚é‡ç‚¹ï¼šå¯¹è¯•ç‚¹é¡¹ç›®å°†åœ¨åœŸåœ°å‡ºè®©ã€è§„åˆ’å®¡æ‰¹ç­‰æ–¹é¢ç»™äºˆæ”¿ç­–å€¾æ–œã€‚å»ºè®®ç›¸å…³ä¼ä¸šå°½å¿«å¯¹æ¥åœ°æ–¹ä¸»ç®¡éƒ¨é—¨ã€‚"
        },
        {
            "id": str(random.randint(1000, 9999)),
            "title": "å…³äºå‘å¸ƒã€Šå»ºç­‘æœºå™¨äººåº”ç”¨æŠ€æœ¯æ ‡å‡†ã€‹çš„å…¬å‘Š",
            "date": today,
            "source": "ä¸­å›½å»ºç­‘ä¸šåä¼š",
            "link": "#",
            "summary": "ã€æ ‡å‡†è§£è¯»ã€‘è¯¥æ ‡å‡†è§„èŒƒäº†æ··å‡åœŸã€ç Œç­‘ç­‰12ç±»å»ºç­‘æœºå™¨äººçš„ä½œä¸šæµç¨‹ã€‚å…³é”®ç‚¹ï¼šé¦–æ¬¡æ˜ç¡®äº†äººæœºåä½œçš„å®‰å…¨è·ç¦»æ ‡å‡†ï¼Œä¸ºå»ºç­‘æœºå™¨äººçš„å¤§è§„æ¨¡å•†ç”¨æä¾›äº†æ³•è§„ä¾æ®ã€‚"
        }
    ]

    # è¯»å–æ—§æ•°æ®
    if os.path.exists('data.json'):
        with open('data.json', 'r', encoding='utf-8') as f:
            try:
                old_data = json.load(f)
            except:
                old_data = []
    else:
        old_data = []

    # åˆå¹¶æ•°æ®
    final_data = new_data + old_data
    # ä¿æŒæœ€æ–°çš„ 20 æ¡
    final_data = final_data[:20]

    # ä¿å­˜
    with open('data.json', 'w', encoding='utf-8') as f:
        json.dump(final_data, f, ensure_ascii=False, indent=2)
    
    print("2. æ™ºèƒ½æ‘˜è¦ç”Ÿæˆå®Œæ¯•")
    print("3. æ•°æ®å·²æ›´æ–°")

if __name__ == "__main__":
    job()
